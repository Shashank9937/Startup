import{u as S,r as u,h as A,f as k,j as e,C as p,M as m}from"./index-CeRVIF18.js";function b(r){return btoa(String.fromCharCode(...new Uint8Array(r)))}function j(r){return Uint8Array.from(atob(r),a=>a.charCodeAt(0))}async function w(r,a){const s=new TextEncoder,l=await crypto.subtle.importKey("raw",s.encode(r),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:a,iterations:1e5,hash:"SHA-256"},l,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function P(r,a){if(!r||!a)return"";const s=new TextEncoder,l=crypto.getRandomValues(new Uint8Array(16)),i=crypto.getRandomValues(new Uint8Array(12)),o=await w(a,l),d=await crypto.subtle.encrypt({name:"AES-GCM",iv:i},o,s.encode(r));return`${b(l)}.${b(i)}.${b(d)}`}async function D(r,a){if(!r||!a)return"";const[s,l,i]=r.split(".");if(!s||!l||!i)return"";const o=j(s),d=j(l),y=j(i),c=await w(a,o),g=await crypto.subtle.decrypt({name:"AES-GCM",iv:d},c,y);return new TextDecoder().decode(g)}function K({onToast:r}){const{state:a,mutate:s,exportJson:l,importJson:i,resetState:o,pullFromServer:d,pushToServer:y}=S(),[c,g]=u.useState(""),[h,v]=u.useState(""),[N,C]=u.useState(""),E=u.useMemo(()=>({day:k(a.profile.startDate),month:A(a.profile.startDate)}),[a.profile.startDate]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(p,{title:"Profile & Preferences",subtitle:"Founder profile, company context, and interface settings",children:[e.jsxs("div",{className:"grid gap-2 md:grid-cols-3",children:[e.jsx("input",{className:"input",placeholder:"Founder name",value:a.profile.founderName,onChange:t=>s(n=>{n.profile.founderName=t.target.value})}),e.jsx("input",{className:"input",placeholder:"Company name",value:a.profile.companyName,onChange:t=>s(n=>{n.profile.companyName=t.target.value})}),e.jsx("input",{className:"input",placeholder:"Stage",value:a.profile.stage,onChange:t=>s(n=>{n.profile.stage=t.target.value})}),e.jsx("input",{className:"input",type:"date",value:a.profile.startDate,onChange:t=>s(n=>{n.profile.startDate=t.target.value})}),e.jsx("input",{className:"input",type:"date",value:a.profile.targetSeriesADate,onChange:t=>s(n=>{n.profile.targetSeriesADate=t.target.value})}),e.jsx("input",{className:"input",placeholder:"Industry/domain",value:a.profile.industry,onChange:t=>s(n=>{n.profile.industry=t.target.value})}),e.jsx("input",{className:"input",placeholder:"Business model",value:a.profile.businessModel,onChange:t=>s(n=>{n.profile.businessModel=t.target.value})}),e.jsx("input",{className:"input",type:"number",placeholder:"Hourly rate",value:a.profile.hourlyRate,onChange:t=>s(n=>{n.profile.hourlyRate=Number(t.target.value)})}),e.jsxs("select",{className:"select",value:a.settings.colorScheme,onChange:t=>s(n=>{n.settings.colorScheme=t.target.value}),children:[e.jsx("option",{value:"blue",children:"Blue"}),e.jsx("option",{value:"emerald",children:"Emerald"}),e.jsx("option",{value:"amber",children:"Amber"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 mt-3",children:[e.jsx(m,{label:"Journey day",value:E.day}),e.jsx(m,{label:"Journey month",value:E.month}),e.jsx(m,{label:"External integrations",value:a.settings.externalIntegrationsEnabled?"Enabled":"Disabled"}),e.jsx(m,{label:"Keyboard shortcuts",value:a.settings.keyboardShortcutsEnabled?"On":"Off"})]})]}),e.jsxs(p,{title:"Sensitive Data Encryption",subtitle:"Encrypt API keys before local storage persistence",children:[e.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[e.jsx("input",{className:"input",type:"password",placeholder:"Encryption passphrase",value:c,onChange:t=>g(t.target.value)}),e.jsx("input",{className:"input",placeholder:"API key hint",value:a.profile.aiApiKeyHint,onChange:t=>s(n=>{n.profile.aiApiKeyHint=t.target.value})}),e.jsx("input",{className:"input md:col-span-2",placeholder:"AI API key (optional)",value:h,onChange:t=>v(t.target.value)})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[e.jsx("button",{className:"btn-primary",onClick:async()=>{if(!h||!c){r("Provide both API key and passphrase.");return}const t=await P(h,c);s(n=>{n.profile.aiApiKeyEncrypted=t}),v(""),r("API key encrypted and stored.")},children:"Encrypt & Save"}),e.jsx("button",{className:"btn-secondary",onClick:async()=>{if(!a.profile.aiApiKeyEncrypted||!c){r("No encrypted key or passphrase missing.");return}try{const t=await D(a.profile.aiApiKeyEncrypted,c);C(t||"(unable to decrypt)")}catch{C("(failed to decrypt)")}},children:"Decrypt Preview"})]}),N?e.jsxs("p",{className:"text-sm mt-2 break-all",children:["Preview: ",N]}):null]}),e.jsx(p,{title:"Data Management",subtitle:"Export, import, sync, and reset",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"btn-primary",onClick:()=>{l(),r("Exported JSON.")},children:"Export all data"}),e.jsxs("label",{className:"btn-secondary cursor-pointer",children:["Import data",e.jsx("input",{type:"file",accept:"application/json,.json",className:"hidden",onChange:async t=>{const n=t.target.files?.[0];n&&(await i(n),r("Imported JSON data."),t.target.value="")}})]}),e.jsx("button",{className:"btn-secondary",onClick:async()=>{await y(),r("Pushed to cloud sync.")},children:"Backup to cloud"}),e.jsx("button",{className:"btn-secondary",onClick:async()=>{await d(),r("Pulled from cloud sync.")},children:"Restore from cloud"}),e.jsx("button",{className:"btn-danger",onClick:()=>{window.confirm("Clear all local data? Export first if needed.")&&(o(),r("All local data cleared."))},children:"Clear data"})]})}),e.jsx(p,{title:"Notifications & Reminders",children:e.jsx("div",{className:"grid gap-2 md:grid-cols-2",children:Object.entries(a.settings.notifications).map(([t,n])=>e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 dark:border-slate-700 px-3 py-2 text-sm",children:[e.jsx("span",{children:t}),e.jsx("input",{type:"checkbox",checked:n,onChange:x=>s(f=>{f.settings.notifications[t]=x.target.checked})})]},t))})}),e.jsxs(p,{title:"Integrations",children:[e.jsx("p",{className:"text-sm text-slate-500 mb-2",children:"No external data transmission unless explicitly enabled."}),e.jsxs("label",{className:"flex items-center gap-2 text-sm mb-2",children:[e.jsx("input",{type:"checkbox",checked:a.settings.externalIntegrationsEnabled,onChange:t=>s(n=>{n.settings.externalIntegrationsEnabled=t.target.checked})}),"Enable external integrations"]}),e.jsx("div",{className:"grid gap-2 md:grid-cols-3",children:Object.entries(a.settings.integrations).map(([t,n])=>e.jsxs("label",{className:"flex items-center justify-between rounded-lg border border-slate-200 dark:border-slate-700 px-3 py-2 text-sm",children:[e.jsx("span",{children:t}),e.jsx("input",{type:"checkbox",checked:n,disabled:!a.settings.externalIntegrationsEnabled,onChange:x=>s(f=>{f.settings.integrations[t]=x.target.checked})})]},t))})]})]})}export{K as default};
