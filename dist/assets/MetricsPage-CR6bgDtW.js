import{u as S,r as E,n as i,j as e,C as x,M as r,p as o,k as h}from"./index-CeRVIF18.js";import{g as L,B as g,X as b,Y as v,f as D,R as N,T as C,L as M}from"./generateCategoricalChart-IE_EzDv6.js";import{L as I,a as w}from"./LineChart-Dsxvh9W_.js";import{C as f,A as R,a as T}from"./AreaChart-CiUURtrX.js";var P=L({chartName:"BarChart",GraphicalChild:g,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:b},{axisType:"yAxis",AxisComp:v}],formatAxisMap:D});function K(a){const n=(i(a.marketingSpend)+i(a.salesCost))/Math.max(1,i(a.newCustomers)),p=i(a.arpu)*i(a.avgLifetimeMonths)*(i(a.grossMarginPct)/100),y=n>0?p/n:0,m=i(a.arpu)>0?n/(i(a.arpu)*(i(a.grossMarginPct)/100)):0;return{cac:n,ltv:p,ratio:y,payback:m}}function G(){const{state:a,mutate:n}=S(),[p,y]=E.useState("mrr"),m=E.useMemo(()=>[...a.metrics.snapshots].sort((s,t)=>s.date.localeCompare(t.date)),[a.metrics.snapshots]),l=m.at(-1)||{},d=K(a.metrics.unitEconomicsInputs),k=a.metrics.expenses.reduce((s,t)=>s+i(t.amount),0),A=i(l.mrr)-k;return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(x,{title:"Growth Dashboard",subtitle:"Primary and secondary metrics for execution quality",children:[e.jsx("div",{className:"mb-3 flex gap-2",children:["mrr","arr","wau","customers"].map(s=>e.jsx("button",{className:`btn-secondary ${p===s?"ring-2 ring-primary-500":""}`,onClick:()=>y(s),children:s.toUpperCase()},s))}),e.jsx("div",{className:"h-64",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(I,{data:m,children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"date"}),e.jsx(v,{}),e.jsx(C,{}),e.jsx(M,{}),e.jsx(w,{type:"monotone",dataKey:p,stroke:"#2563eb",strokeWidth:2}),e.jsx(w,{type:"monotone",dataKey:"momGrowth",stroke:"#059669",strokeWidth:2})]})})}),e.jsxs("div",{className:"grid-cards mt-3",children:[e.jsx(r,{label:"New customers",value:l.newCustomers||0}),e.jsx(r,{label:"Churn rate",value:o(l.churn||0),tone:(l.churn||0)>7?"danger":"success"}),e.jsx(r,{label:"Net revenue retention",value:o(l.nrr||0),tone:(l.nrr||0)>=100?"success":"warning"}),e.jsx(r,{label:"CAC",value:h(l.cac||d.cac)}),e.jsx(r,{label:"LTV",value:h(l.ltv||d.ltv)}),e.jsx(r,{label:"LTV/CAC",value:Number(d.ratio).toFixed(2),tone:d.ratio>=3?"success":"warning"}),e.jsx(r,{label:"Payback period",value:`${Number(d.payback).toFixed(1)} months`,tone:d.payback<=12?"success":"warning"}),e.jsx(r,{label:"Gross margin",value:o(l.grossMargin||a.metrics.unitEconomicsInputs.grossMarginPct)}),e.jsx(r,{label:"Magic number",value:(l.magicNumber||0).toFixed(2),tone:(l.magicNumber||0)>=1?"success":"warning"})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs(x,{title:"Unit Economics Calculator",subtitle:"What-if and benchmark modeling",children:[e.jsxs("div",{className:"grid gap-2 sm:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"ARPU"}),e.jsx("input",{className:"input",type:"number",value:a.metrics.unitEconomicsInputs.arpu,onChange:s=>n(t=>{t.metrics.unitEconomicsInputs.arpu=i(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Avg Customer Lifetime (months)"}),e.jsx("input",{className:"input",type:"number",value:a.metrics.unitEconomicsInputs.avgLifetimeMonths,onChange:s=>n(t=>{t.metrics.unitEconomicsInputs.avgLifetimeMonths=i(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Gross Margin %"}),e.jsx("input",{className:"input",type:"number",value:a.metrics.unitEconomicsInputs.grossMarginPct,onChange:s=>n(t=>{t.metrics.unitEconomicsInputs.grossMarginPct=i(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Marketing Spend"}),e.jsx("input",{className:"input",type:"number",value:a.metrics.unitEconomicsInputs.marketingSpend,onChange:s=>n(t=>{t.metrics.unitEconomicsInputs.marketingSpend=i(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Sales Cost"}),e.jsx("input",{className:"input",type:"number",value:a.metrics.unitEconomicsInputs.salesCost,onChange:s=>n(t=>{t.metrics.unitEconomicsInputs.salesCost=i(s.target.value)})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"New Customers"}),e.jsx("input",{className:"input",type:"number",value:a.metrics.unitEconomicsInputs.newCustomers,onChange:s=>n(t=>{t.metrics.unitEconomicsInputs.newCustomers=i(s.target.value)})})]})]}),e.jsxs("div",{className:"grid-cards mt-3",children:[e.jsx(r,{label:"Calculated LTV",value:h(d.ltv)}),e.jsx(r,{label:"Calculated CAC",value:h(d.cac)}),e.jsx(r,{label:"LTV/CAC",value:d.ratio.toFixed(2),tone:d.ratio>=3?"success":"warning"}),e.jsx(r,{label:"Payback",value:`${d.payback.toFixed(1)} months`,tone:d.payback<=12?"success":"warning"})]})]}),e.jsxs(x,{title:"Cohort Analysis",subtitle:"Retention and revenue retention by cohort",children:[e.jsx("div",{className:"h-56",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(P,{data:a.metrics.cohorts,children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"month"}),e.jsx(v,{}),e.jsx(C,{}),e.jsx(M,{}),e.jsx(g,{dataKey:"d1",fill:"#2563eb",name:"Day 1"}),e.jsx(g,{dataKey:"d7",fill:"#16a34a",name:"Day 7"}),e.jsx(g,{dataKey:"d30",fill:"#f59e0b",name:"Day 30"})]})})}),e.jsx("div",{className:"overflow-auto mt-2",children:e.jsxs("table",{className:"min-w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left border-b border-slate-200 dark:border-slate-700",children:[e.jsx("th",{children:"Month"}),e.jsx("th",{children:"Users"}),e.jsx("th",{children:"D1"}),e.jsx("th",{children:"D7"}),e.jsx("th",{children:"D30"}),e.jsx("th",{children:"Revenue Retention"})]})}),e.jsx("tbody",{children:a.metrics.cohorts.map(s=>e.jsxs("tr",{className:"border-b border-slate-100 dark:border-slate-800",children:[e.jsx("td",{children:s.month}),e.jsx("td",{children:s.users}),e.jsx("td",{children:o(s.d1,0)}),e.jsx("td",{children:o(s.d7,0)}),e.jsx("td",{children:o(s.d30,0)}),e.jsx("td",{children:o(s.revenueRetention,0)})]},s.id))})]})})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs(x,{title:"Burn Rate & Runway",subtitle:"Expense discipline and financial durability",children:[e.jsxs("div",{className:"space-y-2",children:[a.metrics.expenses.map(s=>e.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[e.jsx("input",{className:"input col-span-5",value:s.category,onChange:t=>n(c=>{const u=c.metrics.expenses.find(j=>j.id===s.id);u&&(u.category=t.target.value)})}),e.jsx("input",{className:"input col-span-3",value:s.month,onChange:t=>n(c=>{const u=c.metrics.expenses.find(j=>j.id===s.id);u&&(u.month=t.target.value)})}),e.jsx("input",{className:"input col-span-3",type:"number",value:s.amount,onChange:t=>n(c=>{const u=c.metrics.expenses.find(j=>j.id===s.id);u&&(u.amount=i(t.target.value))})}),e.jsx("button",{className:"text-rose-500 text-xs col-span-1",onClick:()=>n(t=>{t.metrics.expenses=t.metrics.expenses.filter(c=>c.id!==s.id)}),children:"✕"})]},s.id)),e.jsx("button",{className:"btn-secondary",onClick:()=>n(s=>{s.metrics.expenses.push({id:`expense_${Date.now()}`,month:l.date?.slice(0,7)||"",category:"New Expense",amount:0})}),children:"+ Add Expense Category"})]}),e.jsxs("div",{className:"grid-cards mt-3",children:[e.jsx(r,{label:"Total burn",value:h(k),tone:"warning"}),e.jsx(r,{label:"Net run-rate",value:h(A),tone:A>=0?"success":"danger"}),e.jsx(r,{label:"Runway months",value:l.runway||0,tone:(l.runway||0)>12?"success":"warning"})]})]}),e.jsxs(x,{title:"Traction Metrics",subtitle:"Activation, retention and North Star velocity",children:[e.jsx("div",{className:"h-56",children:e.jsx(N,{width:"100%",height:"100%",children:e.jsxs(R,{data:m,children:[e.jsx(f,{strokeDasharray:"3 3"}),e.jsx(b,{dataKey:"date"}),e.jsx(v,{}),e.jsx(C,{}),e.jsx(T,{dataKey:"wau",stroke:"#2563eb",fill:"#93c5fd"}),e.jsx(T,{dataKey:"northStar",stroke:"#16a34a",fill:"#86efac"})]})})}),e.jsxs("div",{className:"grid-cards mt-3",children:[e.jsx(r,{label:"Activation rate",value:o(l.retention||0)}),e.jsx(r,{label:"Day 1 / 7 / 30",value:`${a.metrics.cohorts.at(-1)?.d1||0}/${a.metrics.cohorts.at(-1)?.d7||0}/${a.metrics.cohorts.at(-1)?.d30||0}`,helper:"Latest cohort"}),e.jsx(r,{label:"WoW growth proxy",value:o(((m.at(-1)?.mrr||0)-(m.at(-2)?.mrr||0))/Math.max(1,m.at(-2)?.mrr||1)*100)}),e.jsx(r,{label:"North Star",value:l.northStar||0})]})]})]}),e.jsx(x,{title:"Productivity System",subtitle:"Time audit, elimination, batching, delegation, and focus quality",children:e.jsxs("div",{className:"grid gap-4 lg:grid-cols-2",children:[e.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Time Audit & Allocation"}),a.productivity.timeAudit.map(s=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"text-xs",children:["Strategic %",e.jsx("input",{className:"input mt-1",type:"number",value:s.strategic,onChange:t=>n(c=>{c.productivity.timeAudit[0].strategic=i(t.target.value)})})]}),e.jsxs("label",{className:"text-xs",children:["Execution %",e.jsx("input",{className:"input mt-1",type:"number",value:s.execution,onChange:t=>n(c=>{c.productivity.timeAudit[0].execution=i(t.target.value)})})]}),e.jsxs("label",{className:"text-xs",children:["Management %",e.jsx("input",{className:"input mt-1",type:"number",value:s.management,onChange:t=>n(c=>{c.productivity.timeAudit[0].management=i(t.target.value)})})]}),e.jsxs("label",{className:"text-xs",children:["Waste %",e.jsx("input",{className:"input mt-1",type:"number",value:s.waste,onChange:t=>n(c=>{c.productivity.timeAudit[0].waste=i(t.target.value)})})]})]}),e.jsxs("p",{className:"text-xs text-slate-500",children:["Target mix: Strategic 40%, Execution 30%, Management 20%, Waste ","<","10%, Learning 10%"]})]},s.id))]}),e.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Elimination Tracker"}),e.jsx("button",{className:"btn-secondary mb-2",onClick:()=>n(s=>{s.productivity.elimination.unshift({id:`elim_${Date.now()}`,item:"New eliminated activity",savedHours:1,date:l.date||""})}),children:"+ Add Eliminated Activity"}),e.jsx("div",{className:"space-y-1",children:a.productivity.elimination.map(s=>e.jsxs("div",{className:"rounded-md bg-slate-50 dark:bg-slate-800/60 p-2 text-sm flex justify-between gap-2",children:[e.jsx("span",{children:s.item}),e.jsxs("span",{children:[s.savedHours,"h/week"]})]},s.id))})]}),e.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Batching Schedule Adherence"}),e.jsx("div",{className:"space-y-2",children:a.productivity.batchingSchedule.map(s=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsxs("span",{children:[s.day,": ",s.focus]}),e.jsxs("span",{children:[s.adherence,"%"]})]}),e.jsx("div",{className:"h-2 rounded-full bg-slate-200 dark:bg-slate-700",children:e.jsx("div",{className:`h-2 rounded-full ${s.adherence<60?"bg-rose-500":s.adherence<80?"bg-amber-500":"bg-emerald-500"}`,style:{width:`${s.adherence}%`}})})]},s.day))})]}),e.jsxs("section",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3",children:[e.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Delegation & Focus Sessions"}),e.jsx("div",{className:"space-y-1 mb-2",children:a.productivity.delegation.map(s=>e.jsxs("div",{className:"text-sm rounded-md bg-slate-50 dark:bg-slate-800/60 p-2",children:[s.task," → ",s.delegatedTo," (",s.savedHours,"h saved)"]},s.id))}),e.jsx("div",{className:"space-y-1",children:a.productivity.focusSessions.map(s=>e.jsxs("div",{className:"text-sm rounded-md bg-slate-50 dark:bg-slate-800/60 p-2",children:[s.date,": ",s.pomodoros," pomodoros, ",s.deepWorkMins," mins deep work, ",s.distractions," distractions"]},s.id))})]})]})})]})}export{G as default};
