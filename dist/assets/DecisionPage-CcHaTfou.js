import{u as N,r as c,e as g,j as t,C as x,M as d,E as h,x as f}from"./index-CeRVIF18.js";function y(r){const l=["Assumptions are based on too little data","Execution bandwidth is underestimated","Customer adoption friction is higher than expected","Hidden dependencies block delivery","Decision quality drops due to urgency bias"];return{id:`premortem_${Date.now()}`,date:f(),decisionDraft:r,failures:l,mitigations:["Define leading indicators and early warning thresholds","Add a reversal checkpoint in 2-4 weeks","Assign explicit owner and cadence"]}}function D(){const{state:r,mutate:l}=N(),[m,v]=c.useState(""),[o,j]=c.useState("all"),[s,i]=c.useState({statement:"",date:g(),context:"",options:"",criteria:"",chosen:"",reasoning:"",expectedOutcomes:"",mentalModels:"",reversibility:"Two-way",monitoringPlan:"",reviewDate:g(),reversalCriteria:"",tags:""}),u=c.useMemo(()=>r.decisions.items.filter(e=>{const a=`${e.statement} ${e.reasoning} ${e.tags?.join(" ")}`.toLowerCase(),n=!m||a.includes(m.toLowerCase()),b=o==="all"||(e.tags||[]).includes(o);return n&&b}),[r.decisions.items,m,o]),p=c.useMemo(()=>{const e={};return r.decisions.items.forEach(a=>{(a.mentalModels||[]).forEach(n=>{e[n]=(e[n]||0)+1})}),Object.entries(e).sort((a,n)=>n[1]-a[1])},[r.decisions.items]);return t.jsxs("div",{className:"space-y-4",children:[t.jsxs(x,{title:"Decision Entry",subtitle:"Document reversible and irreversible bets with explicit monitoring",children:[t.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[t.jsx("input",{className:"input",placeholder:"Decision statement",value:s.statement,onChange:e=>i(a=>({...a,statement:e.target.value}))}),t.jsx("input",{className:"input",type:"date",value:s.date,onChange:e=>i(a=>({...a,date:e.target.value}))}),t.jsx("textarea",{className:"textarea",placeholder:"Context",value:s.context,onChange:e=>i(a=>({...a,context:e.target.value}))}),t.jsx("textarea",{className:"textarea",placeholder:"Options considered (one per line)",value:s.options,onChange:e=>i(a=>({...a,options:e.target.value}))}),t.jsx("textarea",{className:"textarea",placeholder:"Decision criteria",value:s.criteria,onChange:e=>i(a=>({...a,criteria:e.target.value}))}),t.jsx("textarea",{className:"textarea",placeholder:"Chosen option",value:s.chosen,onChange:e=>i(a=>({...a,chosen:e.target.value}))}),t.jsx("textarea",{className:"textarea",placeholder:"Reasoning",value:s.reasoning,onChange:e=>i(a=>({...a,reasoning:e.target.value}))}),t.jsx("textarea",{className:"textarea",placeholder:"Expected outcomes (base/best/worst)",value:s.expectedOutcomes,onChange:e=>i(a=>({...a,expectedOutcomes:e.target.value}))}),t.jsx("input",{className:"input",placeholder:"Mental models used (comma separated)",value:s.mentalModels,onChange:e=>i(a=>({...a,mentalModels:e.target.value}))}),t.jsxs("select",{className:"select",value:s.reversibility,onChange:e=>i(a=>({...a,reversibility:e.target.value})),children:[t.jsx("option",{children:"Two-way"}),t.jsx("option",{children:"One-way"})]}),t.jsx("textarea",{className:"textarea",placeholder:"Monitoring plan",value:s.monitoringPlan,onChange:e=>i(a=>({...a,monitoringPlan:e.target.value}))}),t.jsx("input",{className:"input",type:"date",value:s.reviewDate,onChange:e=>i(a=>({...a,reviewDate:e.target.value}))}),t.jsx("textarea",{className:"textarea",placeholder:"Reversal criteria",value:s.reversalCriteria,onChange:e=>i(a=>({...a,reversalCriteria:e.target.value}))}),t.jsx("input",{className:"input",placeholder:"Tags/categories (comma separated)",value:s.tags,onChange:e=>i(a=>({...a,tags:e.target.value}))})]}),t.jsxs("div",{className:"flex flex-wrap gap-2 mt-3",children:[t.jsx("button",{className:"btn-primary",onClick:()=>{s.statement.trim()&&(l(e=>{e.decisions.items.unshift({id:`decision_${Date.now()}`,date:s.date,statement:s.statement,context:s.context,options:s.options.split(`
`).filter(Boolean),criteria:s.criteria,chosen:s.chosen,reasoning:s.reasoning,expectedOutcomes:s.expectedOutcomes,mentalModels:s.mentalModels.split(",").map(a=>a.trim()).filter(Boolean),reversibility:s.reversibility,monitoringPlan:s.monitoringPlan,reviewDate:s.reviewDate,reversalCriteria:s.reversalCriteria,tags:s.tags.split(",").map(a=>a.trim()).filter(Boolean),qualityScore:0,reviewStatus:"pending"})}),i(e=>({...e,statement:"",context:"",options:"",criteria:"",chosen:"",reasoning:"",expectedOutcomes:"",mentalModels:"",monitoringPlan:"",reversalCriteria:"",tags:""})))},children:"Save Decision"}),t.jsx("button",{className:"btn-secondary",onClick:()=>l(e=>{e.decisions.premortems.unshift(y(s.statement||"Untitled decision"))}),children:"Run Pre-Mortem"})]})]}),t.jsxs(x,{title:"Decision Dashboard",subtitle:"Timeline, search, filters, and quality analytics",children:[t.jsxs("div",{className:"grid gap-2 md:grid-cols-3 mb-3",children:[t.jsx("input",{className:"input",placeholder:"Search decisions",value:m,onChange:e=>v(e.target.value)}),t.jsx("input",{className:"input",placeholder:"Filter by tag",value:o==="all"?"":o,onChange:e=>j(e.target.value||"all")}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx(d,{label:"Total decisions",value:r.decisions.items.length}),t.jsx(d,{label:"Avg decision speed",value:`${2.4} days`})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-3 mb-3",children:[t.jsx(d,{label:"Most-used model",value:p[0]?.[0]||"N/A",helper:`${p[0]?.[1]||0} uses`}),t.jsx(d,{label:"Pending reviews",value:r.decisions.items.filter(e=>e.reviewStatus!=="done").length}),t.jsx(d,{label:"Two-way decisions",value:r.decisions.items.filter(e=>e.reversibility==="Two-way").length})]}),t.jsxs("div",{className:"space-y-2",children:[u.length===0?t.jsx(h,{message:"No decisions found"}):null,u.map(e=>t.jsxs("article",{className:"rounded-xl border border-slate-200 dark:border-slate-700 p-3",children:[t.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"font-semibold",children:e.statement}),t.jsxs("p",{className:"text-xs text-slate-500",children:[e.date," • ",e.reversibility]})]}),t.jsx("button",{className:"text-rose-500 text-xs",onClick:()=>l(a=>{a.decisions.items=a.decisions.items.filter(n=>n.id!==e.id)}),children:"Delete"})]}),t.jsx("p",{className:"text-sm mt-1 text-slate-600 dark:text-slate-300",children:e.reasoning}),t.jsxs("p",{className:"text-xs mt-1 text-slate-500",children:["Review date: ",e.reviewDate," • Reversal: ",e.reversalCriteria]}),t.jsx("div",{className:"mt-2 flex flex-wrap gap-1",children:(e.mentalModels||[]).map(a=>t.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-slate-200 dark:bg-slate-800",children:a},`${e.id}_${a}`))})]},e.id))]})]}),t.jsxs(x,{title:"Pre-Mortem Queue",subtitle:"Potential failures and mitigations before committing irreversible bets",children:[r.decisions.premortems.length===0?t.jsx(h,{message:"No pre-mortems generated"}):null,t.jsx("div",{className:"space-y-2",children:r.decisions.premortems.map(e=>t.jsxs("div",{className:"rounded-xl border border-amber-200 dark:border-amber-700/40 p-3 bg-amber-50/70 dark:bg-amber-950/20",children:[t.jsx("p",{className:"font-medium text-sm",children:e.decisionDraft}),t.jsx("ul",{className:"list-disc ml-5 mt-1 text-sm",children:e.failures.map(a=>t.jsx("li",{children:a},`${e.id}_${a}`))}),t.jsxs("p",{className:"text-xs text-slate-500 mt-2",children:["Mitigations: ",e.mitigations.join(" • ")]})]},e.id))})]})]})}export{D as default};
